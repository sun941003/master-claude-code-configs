# 팀 에이전트 프로토콜
> 원본: docs/TOOLCHAIN_STRATEGY.md 참조

## 핵심 원칙
자동 병렬, 최대 속도, 안정성 보장.
모든 작업은 수신 즉시 병렬 가능 여부를 분석하고, 충돌 없는 작업은 사용자 확인 없이 자동 팀 에이전트에 분배.

## 자동 분배 판단 흐름
1. 작업 수신 → 하위 태스크로 분해
2. 의존 그래프 분석:
   - 파일 충돌 (같은 파일 수정 여부)
   - 모듈 충돌 (같은 도메인 모듈 여부)
   - 레이어 의존성 (UseCase → Repository 순서 등)
3. 충돌 없는 그룹 → 즉시 병렬 에이전트 할당
4. 충돌 있는 작업 → DAG 순서로 순차 배치
5. 빌드 검증: 모든 에이전트 완료 후 통합 빌드 1회

## 병렬 작업 분해 기준
- 도메인 독립: settlement ↔ ledger ↔ auth → 병렬 OK
- 플랫폼 독립: Android actual ↔ iOS actual → 병렬 OK
- 테스트 독립: 서로 다른 VM 테스트 → 병렬 OK
- 레이어 의존: ViewModel → UseCase → Repository → 순차
- 공유 파일 수정: build.gradle, DI 모듈 → 순차 (1개 에이전트만)

## 에이전트 실행 규칙
- 각 에이전트는 담당 modules/*.md만 읽고 시작 (토큰 절약)
- rules/*.md는 모든 에이전트가 공통으로 따름
- 에이전트 간 통신: 공유 파일 수정 금지, 각자 독립 브랜치
- 작업 완료: 커밋 → 메인 에이전트가 dev 머지 순서 관리
- Gradle 빌드: 빌드 큐 (라운드 로빈), 1개만 동시 실행
- 컴파일 실패 시: 해당 에이전트만 롤백, 다른 에이전트 영향 없음

## 성능 극대화 전략
- 코드 작성은 병렬, 빌드/테스트는 순차 큐
- I/O 집중 작업(번역, 에셋)은 별도 에이전트가 배치 처리
- idle 에이전트는 코드 리뷰/분석으로 전환
- 작업 크기 불균형 시: 큰 작업을 추가 분할

## 에이전트 식별
- Agent-F: Feature Development (기능 + 버그)
- Agent-T: Test & QA (테스트 + 검증)
- Agent-I: i18n & Assets (번역 + 에셋)
- Agent-C: CI/CD & Deploy (빌드 + 배포)
- Agent-R: Refactor & Performance (리팩토링 + 기술부채)
