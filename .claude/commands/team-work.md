---
description: 작업 분석 후 Agent Teams 병렬 실행 또는 최적 방식 추천
argument-hint: <task-description>
---

$ARGUMENTS

## Phase 1: 작업 분석 및 실행 방식 판단

아래 기준으로 사용자 요청을 분석하고 최적 실행 방식을 결정한다.

### 판단 매트릭스

| 조건 | 실행 방식 |
|------|----------|
| 단일 파일, 간단한 수정 | **Single Session** — 바로 실행 |
| 독립적 작업 2-3개, 결과만 필요 | **Sub-Agent** — Task tool로 병렬 |
| 3+ 레이어/모듈, 팀원 간 소통 필요 | **Agent Teams** — 팀 생성 |
| 복잡한 디버깅, 경쟁 가설 필요 | **Agent Teams** — 가설별 팀원 |
| 코드 리뷰, 다각도 분석 필요 | **Agent Teams** — 관점별 팀원 |

### 분석 출력 (반드시 사용자에게 표시)

```
## 작업 분석 결과

**요청 요약**: {한 줄 요약}
**복잡도**: {Low / Medium / High / Critical}
**추천 방식**: {Single Session / Sub-Agent / Agent Teams}
**근거**: {판단 이유 1-2줄}
```

---

## Phase 2: Agent Teams 추천 시 — 팀 구성안 제시

Agent Teams로 판단된 경우, 아래 형식으로 팀 구성안을 제시한다.
**사용자 승인 후** 팀을 생성한다.

```
## 팀 구성 제안

| # | 역할 | 모델 | 담당 영역 | 소유 파일/패키지 |
|---|------|------|----------|----------------|
| 1 | {역할명} | {Opus/Sonnet/Haiku} | {구체적 작업} | {파일 경계} |
| 2 | ... | ... | ... | ... |

### 의존성
- 팀원 1 완료 → 팀원 2 시작 (또는 "모두 독립, 병렬 가능")

### 예상 토큰 배수
- 팀원 {N}명 × 개별 세션 ≈ {N}x 소모

### 파일 충돌 방지
- {각 팀원의 파일 경계 명시}
```

**Sub-Agent/Single Session 판단 시**: 해당 방식으로 즉시 실행한다.

---

## Phase 3: 팀 생성 및 실행

사용자 승인 후:

1. **Contract First**: 팀원 간 접점(인터페이스, UiState, Resource Key) 확정
2. **팀 생성**: TeamCreate로 팀 생성, Task tool로 팀원 spawn
3. **태스크 분배**: TaskCreate로 공유 태스크 리스트 생성
4. **모니터링**: 진행 상황을 주기적 확인, 파일 충돌 감시
5. **품질 검증**: 팀원 결과물의 아키텍처 정합성 검증

### 팀원 spawn 시 필수 포함 정보
- 프로젝트 컨텍스트 (기술 스택, 패키지 구조)
- 정확한 파일 경로와 소유 범위
- 완료 기준 (Acceptance Criteria)
- 다른 팀원과의 인터페이스 계약

### 모델 배정 기준
- 아키텍처 설계/복잡한 로직: **Opus**
- 일반 구현/UI/테스트: **Sonnet**
- 리소스/포매팅/단순 작업: **Haiku**

---

## Phase 4: 작업 완료 및 팀 정리

모든 태스크 완료 후:

1. **통합 검증**: 팀원 결과물 간 import/인터페이스 정합성 확인
2. **빌드 체크**: `/build-check` 실행 (Android + iOS)
3. **변경 보고**: `git diff` 기반 변경사항 한국어 보고

```
## 팀 작업 완료 보고

| 팀원 | 역할 | 생성/수정 파일 | 상태 |
|------|------|-------------|------|
| ... | ... | ... | 완료/이슈 |

### 빌드 결과
- Android: {PASS/FAIL}
- iOS: {PASS/FAIL}
```

4. **팀 정리 실행**:
   - 각 팀원에게 shutdown_request 전송
   - 모든 팀원 종료 확인
   - TeamDelete로 팀 리소스 해제
   - "팀이 정리되었습니다" 보고

5. **문서 동기화**: 작업 완료 프로토콜(섹션 8) 실행
